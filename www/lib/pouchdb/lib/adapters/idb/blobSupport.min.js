"use strict";function checkBlobSupport(e,t){return new utils.Promise(function(n,r){var i=createBlob([""],{type:"image/png"});e.objectStore(DETECT_BLOB_SUPPORT_STORE).put(i,"key"),e.oncomplete=function(){var e=t.transaction([DETECT_BLOB_SUPPORT_STORE],"readwrite"),i=e.objectStore(DETECT_BLOB_SUPPORT_STORE).get("key");i.onerror=r,i.onsuccess=function(e){var t=e.target.result,r=URL.createObjectURL(t);utils.ajax({url:r,cache:!0,binary:!0},function(e,t){e&&405===e.status?n(!0):(n(!(!t||"image/png"!==t.type)),e&&404===e.status&&utils.explain404("PouchDB is just detecting blob URL support.")),URL.revokeObjectURL(r)})}}})["catch"](function(){return!1})}var utils=require("../../utils"),createBlob=require("../../deps/binary/blob"),idbConstants=require("./constants"),DETECT_BLOB_SUPPORT_STORE=idbConstants.DETECT_BLOB_SUPPORT_STORE;module.exports=checkBlobSupport;
