"use strict";function createMultipart(e){e=clone(e);var t=uuid(),n={};Object.keys(e._attachments).forEach(function(t){var r=e._attachments[t];if(!r.stub){var i=atob(r.data);n[t]={type:r.content_type,data:i},r.length=i.length,r.follows=!0,delete r.digest,delete r.data}});var r="--"+t+"\r\nContent-Type: application/json\r\n\r\n",i=[r,JSON.stringify(e)];Object.keys(n).forEach(function(e){var r=n[e],a="\r\n--"+t+"\r\nContent-Disposition: attachment; filename="+JSON.stringify(e)+"\r\nContent-Type: "+r.type+"\r\nContent-Length: "+r.data.length+"\r\n\r\n";i.push(a),i.push(createMultipartPart(r.data))}),i.push("\r\n--"+t+"--");var a="multipart/related; boundary="+t,o=createBlufferFromParts(i,a);return{headers:{"Content-Type":a},body:o}}var base64=require("./../binary/base64"),atob=base64.atob,uuid=require("./../uuid"),utils=require("../../utils"),clone=utils.clone,createBlufferFromParts=require("./createBlobOrBufferFromParts"),createMultipartPart=require("./createMultipartPart");module.exports=createMultipart;
